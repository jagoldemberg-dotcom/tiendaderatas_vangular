<main class="container py-4">
  <h1 class="h4 mb-3">Carrito</h1>

  <div *ngIf="items.length > 0; else carritoVacio">
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th>Producto</th>
            <th class="text-end">Precio</th>
            <th class="text-center">Cantidad</th>
            <th class="text-end">Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of items">
            <td>{{ item.producto.nombre }}</td>
            <td class="text-end">
              {{ item.producto.precio | currency:'CLP':'symbol-narrow' }}
            </td>
            <td class="text-center">{{ item.cantidad }}</td>
            <td class="text-end">
              {{ item.producto.precio * item.cantidad | currency:'CLP':'symbol-narrow' }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">
      <h2 class="h5 mb-0">
        Total: {{ total | currency:'CLP':'symbol-narrow' }}
      </h2>
    </div>

    <div class="mt-3 d-flex gap-2">
      <a class="btn btn-outline-secondary" routerLink="/products">Seguir comprando</a>
      <button class="btn btn-success" (click)="finalizarCompra()">Finalizar compra</button>
    </div>

    <div *ngIf="mensajeError" class="alert alert-danger mt-3">
      {{ mensajeError }}
    </div>

    <div *ngIf="compraFinalizada" class="alert alert-success mt-3">
      Â¡Compra registrada! Gracias por tu pedido.
    </div>
  </div>

  <ng-template #carritoVacio>
    <p>No hay productos en el carrito.</p>
    <a class="btn btn-primary" routerLink="/products">Ir a productos</a>
  </ng-template>
</main>
